import{r as n,j as e,c as j,R as S}from"./client-BW4HFQ8H.js";function b(){const[y,h]=n.useState([]),[o,m]=n.useState({safe:0,warning:0,danger:0}),[l,c]=n.useState(!1),[i,g]=n.useState(null);n.useEffect(()=>{d(),u()},[]);const d=()=>{chrome.runtime.sendMessage({action:"getSecurityTips"},s=>{s&&g(s)})},u=async()=>{var s;try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(t!=null&&t.id)||!((s=t.url)!=null&&s.startsWith("http")))return;chrome.tabs.sendMessage(t.id,{action:"getScanResults"},a=>{if(chrome.runtime.lastError){console.log("Content script not ready");return}if(a!=null&&a.results){const r=Array.from(a.results);h(r),p(r)}})}catch(t){console.error("Error loading scan results:",t)}},p=s=>{const t={safe:0,warning:0,danger:0};s.forEach(([a,r])=>{r.status==="safe"?t.safe++:r.status==="warning"?t.warning++:r.status==="danger"&&t.danger++}),m(t)},f=async()=>{var s;c(!0);try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(t!=null&&t.id)||!((s=t.url)!=null&&s.startsWith("http"))){alert("Cannot scan this page. Please navigate to a website."),c(!1);return}try{await chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]}),await chrome.scripting.executeScript({target:{tabId:t.id},files:["chatbot.js"]}),await chrome.scripting.insertCSS({target:{tabId:t.id},files:["styles.css","chatbot.css"]})}catch{}setTimeout(()=>{chrome.tabs.sendMessage(t.id,{action:"scanPage"},a=>{c(!1),chrome.runtime.lastError?console.error(chrome.runtime.lastError):setTimeout(u,1e3)})},500)}catch(t){console.error("Scan error:",t),c(!1)}},x=()=>{chrome.runtime.openOptionsPage()};return e.jsxs("div",{className:"popup-container",children:[e.jsxs("div",{className:"popup-header",children:[e.jsx("h1",{children:"ğŸ›¡ï¸ Cyvex Security"}),e.jsx("p",{children:"Phishing Protection"})]}),e.jsxs("div",{className:"popup-stats",children:[e.jsxs("div",{className:"stat-card stat-safe",children:[e.jsx("div",{className:"stat-number",children:o.safe}),e.jsx("div",{className:"stat-label",children:"Safe"})]}),e.jsxs("div",{className:"stat-card stat-warning",children:[e.jsx("div",{className:"stat-number",children:o.warning}),e.jsx("div",{className:"stat-label",children:"Warnings"})]}),e.jsxs("div",{className:"stat-card stat-danger",children:[e.jsx("div",{className:"stat-number",children:o.danger}),e.jsx("div",{className:"stat-label",children:"Dangerous"})]})]}),e.jsx("button",{className:"scan-button",onClick:f,disabled:l,children:l?"ğŸ” Scanning...":"ğŸ” Scan This Page"}),i&&e.jsxs("div",{className:"security-tip",children:[e.jsx("div",{className:"tip-title",children:"ğŸ’¡ Security Tip"}),e.jsxs("div",{className:"tip-content",children:[e.jsx("strong",{children:i.title}),e.jsx("p",{children:i.content}),e.jsx("em",{className:"tip-category",children:i.category})]})]}),e.jsxs("div",{className:"popup-footer",children:[e.jsx("button",{className:"footer-button",onClick:x,children:"âš™ï¸ Settings"}),e.jsx("button",{className:"footer-button",onClick:d,children:"ğŸ’¡ New Tip"})]})]})}j.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(b,{})}));
